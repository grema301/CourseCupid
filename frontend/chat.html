<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CourseCupid ‚Ä¢ Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind CDN (you already use this in index.html) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { cupidPink: '#C05A66', cupidCream: '#FAF5EF' },
          fontFamily: { script: ['"Great Vibes"', 'cursive'], sans: ['Inter', 'sans-serif'] }
        }
      }
    }
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* Small custom styles to complement Tailwind */
    .animated-gradient {
      background: linear-gradient(90deg, #C05A66, #DB2777);
      background-size: 200% 200%;
      color: white;
    }
    .hover-lift { transition: all 0.22s cubic-bezier(.2,.9,.3,1); }
    .hover-lift:hover { transform: translateY(-4px); box-shadow: 0 10px 30px rgba(176,55,85,0.12); }
    .match-card:hover { background: rgba(192,90,102,0.04); }
    .bubble-user { align-self:flex-end; background: linear-gradient(180deg,#fff,#f3f0ef); color:#1f2937; border-radius: 16px 16px 4px 16px; padding:10px 12px; max-width:70%; }
    .bubble-ai   { align-self:flex-start; background: linear-gradient(180deg,#fee2e2,#ffdede); color:#2d032d; border-radius: 16px 16px 16px 4px; padding:10px 12px; max-width:70%; }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-b from-white to-cupidCream font-sans">
  <!-- Header (small) -->
  <header class="flex items-center justify-between px-6 py-4 border-b border-cupidPink/10 bg-white/70">
    <a href="/" class="flex items-center gap-3 hover-lift group">
      <svg class="w-5 h-5 text-cupidPink transition-transform duration-300 group-hover:-translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      <span class="text-base sm:text-lg font-semibold text-cupidPink transition-colors duration-300 group-hover:text-cupidPink/80">Back to Home</span>
    </a>
    <a href="/" class="flex items-center gap-3">
      <img src="/images/cupid_logo.png" alt="CourseCupid" class="h-8">
      <span class="text-lg font-semibold text-cupidPink">CourseCupid</span>
    </a> 
    <div>
      <a href="/quiz" class="px-4 py-2 rounded-full border border-cupidPink/10 text-cupidPink hover:bg-cupidPink/10 hover:shadow-sm">Take Quiz</a>
    </div>
  </header>

  <div class="flex h-[calc(100vh-72px)]">
    <!-- SIDEBAR -->
    <aside id="sidebar" class="w-80 bg-white border-r border-cupidPink/10 flex flex-col">
      <div class="px-4 py-4 flex items-center justify-between border-b border-cupidPink/10">
        <div>
          <div class="text-sm text-cupidPink font-semibold">üíå Your Matches</div>
          <div id="match-count" class="text-xs text-gray-500">Loading...</div>
        </div>
        <a href="/chat" class="text-sm text-gray-500 hover:text-cupidPink">Refresh</a>
      </div>

      <!-- Cupid Chat Sessions Section -->
      <div class="border-b border-cupidPink/10">
        <div class="px-4 py-2 text-xs text-gray-600 font-semibold uppercase tracking-wide">
          üíò Cupid Chats 
          <button id="add-chat-btn" class="text-center px-3 py-2 rounded-full animated-gradient hover-lift" onclick="startCreateSession()">
            <span id="chat-btn-text">Create A New Cupid Chat</span>
          </button>
        </div>
        <div id="cupidChatList" class="max-h-60 overflow-y-auto p-3 space-y-2">
          <!-- JS will inject cupid chats here -->
        </div>
      </div>

      <!-- Paper Match Sessions Section -->
      <div class="flex-1 flex flex-col min-h-0">
        <div class="px-4 py-2 text-xs text-gray-600 font-semibold uppercase tracking-wide">
          üìö Paper Matches
        </div>
        <div id="matchList" class="flex-1 overflow-y-auto p-3 space-y-2">
          <!-- JS will inject match cards here -->
        </div>
      </div>

      <div class="p-3 border-t border-cupidPink/10">
        <a href="/papers.html" class="w-full block text-center px-3 py-2 rounded-full animated-gradient hover-lift">Browse Papers</a>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="flex-1 flex flex-col min-h-0">
      <!-- Placeholder when no paper selected -->
      <div id="placeholder" class="flex-1 flex flex-col items-center justify-center gap-4 text-center text-gray-600">
        <div class="text-7xl">‚ù§</div>
        <h2 class="text-2xl font-semibold text-cupidPink">Pick a match to start chatting</h2>
        <p class="max-w-xl">Click a paper on the left (matches you've swiped right on). If you want a fresh match, try the quiz and swipe on recommended papers.</p>
      </div>

      <!-- Chat Panel (hidden until a paper selected) -->
      <div id="chatPanel" class="hidden flex-1 min-h-0 flex flex-col bg-gradient-to-b from-white/60 to-cupidCream/40">
        <!-- header -->
        <div class="flex items-center gap-3 px-4 py-3 border-b border-cupidPink/10 bg-white/70">
          <div id="paperAvatar" class="w-12 h-12 rounded-lg bg-cupidPink text-white flex items-center justify-center text-xl"></div>
          <div class="flex-1">
            <div id="paperTitle" class="font-semibold text-lg text-cupidPink">Loading‚Ä¶</div>
            <div id="paperSubtitle" class="text-xs text-gray-500">Tap the avatar to view paper page</div>
            <button id="delete-chat-btn" class="text-xs text-center px-3 py-2 rounded-full animated-gradient hover-lift"onclick="deleteSession()">
              <span id="chat-btn-text">Delete Current Chat</span>
            </button>
          </div>
          <div class="text-sm text-gray-500">Session: <span id="current-session-id">‚Äî</span></div>
        </div>

        <!-- messages -->
        <div id="chatWindow" class="flex-1 min-h-0 p-4 overflow-y-auto flex flex-col gap-3">
          <!-- messages appended here -->
        </div>

        <!-- input -->
        <form id="chatForm" class="px-4 py-3 border-t border-cupidPink/10 flex items-center gap-3 bg-white/70">
          <input id="chatInput" type="text" placeholder="Ask about assessments, workload, or what makes me special‚Ä¶" class="flex-1 rounded-full border border-gray-200 px-4 py-2 focus:outline-none" required />
          <button id="sendBtn" class="px-4 py-2 rounded-full animated-gradient hover-lift">Send</button>
        </form>
      </div>
    </main>
  </div>

  <!-- chat app script -->
  <script src="/js/chat.js"></script>
  <script src="../app.js"></script>
</body>
</html>
